var lpu=Array();
var npu=0;

lpu[npu]='1|JANTHO|PADI|95.648974065701|5.2968660250557';npu++;
lpu[npu]='2|PATEK|PADI|95.4780482|4.8697420361446';npu++;
lpu[npu]='3|COT GIREK|KELAPA SAWIT|97.401128123347|4.9376921678535';npu++;
lpu[npu]='4|PINTU RIME GAYO|KOPI|96.739279989393|4.8930953338244';npu++;
lpu[npu]='5|KEDURANG|PADI|103.06321420699|-4.4516323729483';npu++;
lpu[npu]='6|BELANTIKAN RAYA|KARET|111.48250182941|-1.7424877674208';npu++;
lpu[npu]='7|TONGO-SEKONGKANG|JAGUNG|116.89590445278|-9.0389335045807';npu++;
lpu[npu]='8|PETATA|PADI|104.11867|-3.1807962150042';npu++;
lpu[npu]='9|LARANTUKA|HORTIKULTURA (JAMBU METE)|122.83878668271|-8.410552181';npu++;
lpu[npu]='10|JELAI (PULAU NIBUNG)|PADI|110.82867|-2.94293';npu++;
lpu[npu]='11|BAJAWA|KOPI|120.91840027706|-8.6781776530137';npu++;
lpu[npu]='12|MAWASANGKA|HORTIKULTURA (JAMBU METE)|122.37982752753|-5.2859206854419';npu++;
lpu[npu]='13|KUMPEH|KELAPA SAWIT|103.86682764373|-1.4168293989333';npu++;
lpu[npu]='14|SUMALATA|JAGUNG|122.7893|0.89041';npu++;
lpu[npu]='15|PADANG ULAK TANDING|KOPI|102.81402661419|-3.4066017332988';npu++;
lpu[npu]='16|TERENTANG|PADI|109.58752000676|-0.37816896960064';npu++;
lpu[npu]='17|TUMBANG JUTUH - BERENG BELAWAN|KELAPA SAWIT|113.59802209852|-1.3378924285714';npu++;
lpu[npu]='18|LAMBALE|KELAPA|123.08794328205|-4.8217750607287';npu++;
lpu[npu]='19|MENGKENDEK|KOPI|119.91561407164|-3.2107214341058';npu++;
lpu[npu]='20|RANTE KARUA|KOPI|119.77858371083|-2.898156614225';npu++;
lpu[npu]='21|GILIRENG|PADI|120.23025534002|-3.8215160828688';npu++;
lpu[npu]='22|WERIANGGI - WERABUR|HORTIKULTURA (PISANG)|134.23326406164|-2.5566903372781';npu++;
lpu[npu]='23|PAYAHE|KELAPA|127.73425679036|0.24768467773438';npu++;
lpu[npu]='24|KLAMONO-SEGUN|KAKAO|131.4667799565|-1.1841866109728';npu++;
lpu[npu]='25|SEULIMEUM|JAGUNG|95.5898443564|5.4478199507011';npu++;
lpu[npu]='26|KOLONO|KAKAO|122.61547587117|-4.2119694945256';npu++;
lpu[npu]='27|JEBUS|LADA|105.51|-1.7979';npu++;
lpu[npu]='28|MATAN HILIR SELATAN|PADI|110.3020488593|-1.9637272138223';npu++;
lpu[npu]='29|SEBAMBAN|PERIKANAN TANGKAP|115.70888319811|-3.6870253508274';npu++;
lpu[npu]='30|GULA HABANG|KARET|115.47737703168|-2.3636110243902';npu++;
lpu[npu]='31|MUARA KUANG|KARET|104.57873095489|-3.670979887218';npu++;
lpu[npu]='32|PATLEAN|PADI|128.70188545241|1.368276531258';npu++;
lpu[npu]='33|MOMIWAREN|PERIKANAN TANGKAP|134.17095398967|-1.451456681459';npu++;
lpu[npu]='34|SALAKAN|PERIKANAN TANGKAP|123.22499879683|-1.57082333708612';npu++;
lpu[npu]='35|PALOLO|KOPI|120.017|-1.0764431259233';npu++;
lpu[npu]='36|PADAULOYO|KELAPA|121.8646319704|-1.0888630249249';npu++;
lpu[npu]='37|BASIDONDO|CENGKEH|120.68930821411|0.84219432909794';npu++;
lpu[npu]='38|ANAWUA|PADI|121.57311906587|-4.5312829654691';npu++;
lpu[npu]='39|WOYLA|PADI|96.038002784951|4.4596492535271';npu++;
lpu[npu]='40|SAMAR KILANG|KOPI|97.123663747815|4.7182449250152';npu++;
lpu[npu]='41|SUBULUSSALAM|KELAPA SAWIT|97.886194438725|2.6487218327206';npu++;
lpu[npu]='42|MUARA SAHUNG|PADI|103.34120071879|-4.6274974048036';npu++;
lpu[npu]='43|GERAGAI|KELAPA SAWIT|103.7864|-1.191';npu++;
lpu[npu]='44|JAGOI BABANG|PADI|109.8091300043|1.3070694395161';npu++;
lpu[npu]='45|KERANG|KELAPA SAWIT|116.1252689394|-2.1545319780244';npu++;
lpu[npu]='46|KETUNGAU HULU|KELAPA SAWIT|111.18881895873|0.99915082882883';npu++;
lpu[npu]='47|KALUKKU|KAKAO|119.40822054988|-2.5077820081759';npu++;
lpu[npu]='48|SARUDU BARAS|JAGUNG|119.3652354732|-1.5190280260546';npu++;
lpu[npu]='49|ULUIWOI|KELAPA SAWIT|121.543|-3.6905228989187';npu++;
lpu[npu]='50|LASALIMU|KELAPA|123.13155342794|-5.331447579488';npu++;
lpu[npu]='51|ROUTA|KAKAO|121.64442|-3.654';npu++;
lpu[npu]='52|HIALU|CENGKEH|122.16194821095|-3.2976594099417';npu++;
lpu[npu]='53|MARIORIWAWO|KAKAO|119.94344174724|-4.505415762867';npu++;
lpu[npu]='54|MASAMBA|PADI|120.35201676478|-2.502984596401';npu++;
lpu[npu]='55|TANGLAPUI|VANILI|124.63944050031|-8.3655107620795';npu++;
lpu[npu]='56|BENA|PADI|124.39232758358|-10.087317719953';npu++;
lpu[npu]='57|SENGGI|PADI|140.68478461152|-3.4172875174419';npu++;
lpu[npu]='58|BOMBERAY - TOMAGE|PALA|132.90017179922|-2.8333430892565';npu++;
lpu[npu]='59|BUMI ASRI|KELAPA SAWIT|101.44498597382|-1.3812565787538';npu++;
lpu[npu]='60|SEKO|PADI|119.91292965497|-2.2832015672515';npu++;
lpu[npu]='61|LEREH|SAGU|140.06344665084|-3.0103309973862';npu++;
lpu[npu]='62|WERI - SAHAREY|PALA|132.5953575598|-3.135430195342';npu++;
lpu[npu]='63|MENTEBAH|PADI|112.72727418605|0.839116';npu++;
lpu[npu]='64|PITURIASE|PADI|120.02659481206|-3.8023839988627';npu++;
lpu[npu]='65|PULAU RUPAT|KELAPA SAWIT|101.65036006061|1.9865304199134';npu++;
lpu[npu]='66|MUTIARA|KAKAO|122.853291|-4.8267809584578';npu++;
lpu[npu]='67|BATHIN III|JAGUNG|101.89252641218|-1.6818503163673';npu++;
lpu[npu]='68|LATIUNG|KELAPA|96.45109506|2.4096766';npu++;
lpu[npu]='69|HARUS MUDA JAYA|PERIKANAN BUDIDAYA|96.514662724896|5.1431511835774';npu++;
lpu[npu]='70|KETAPANG NUSANTARA|PADI|97.115383944|4.4163367624633';npu++;
lpu[npu]='71|BATHIN IX|PADI|102.92439233|-2.2236372975';npu++;
lpu[npu]='72|SEI MANGGARIS|KELAPA SAWIT|117.3221959091|4.238697158628';npu++;
lpu[npu]='73|LAMUNTI - DADAHUP|PADI|114.64669709172|-2.681985984714';npu++;
lpu[npu]='74|PULAU BACAN|KELAPA|127.39213855522|-0.41527774323578';npu++;
lpu[npu]='75|TOLIWANG|KELAPA|127.97978567586|1.3935316210709';npu++;
lpu[npu]='76|MANGOLI|KELAPA|125.4679|-1.9147';npu++;
lpu[npu]='77|TASIFETO-MANDEU|JAGUNG|125.00362064199|-9.0755926200504';npu++;
lpu[npu]='78|AMFOANG|PETERNAKAN|123.78523652836|-9.6517391578728';npu++;
lpu[npu]='79|KOBALIMA TIMUR|KEMIRI|124.91503|-9.60236';npu++;
lpu[npu]='80|MUTING|PADI|140.63012728535|-7.3968793055556';npu++;
lpu[npu]='81|ULUMANDA|KOPI|118.91194322246|-3.0942881781454';npu++;
lpu[npu]='82|LALUNDU DAN BAMBAKAENU|KOPI|119.70718196464|-1.0671511901141';npu++;
lpu[npu]='83|BUNGKU UTARA|PADI|121.767|-1.744';npu++;
lpu[npu]='84|ULUBONGKA|KELAPA|121.462|-1.0993654967184';npu++;
lpu[npu]='85|TINANGGEA|KAKAO|122.15542964801|-4.3518469295139';npu++;
lpu[npu]='86|SIMPANG RIMAU-MUARA KELINGI|KELAPA SAWIT|103.36984295881|-3.2587574970268';npu++;
lpu[npu]='87|MUARA TAKUNG-KAMANG BARU|KELAPA SAWIT|101.29206751512|-0.75577144936709';npu++;
lpu[npu]='88|WAY KANAN|PADI|104.46957992498|-4.3374581022259';npu++;
lpu[npu]='89|SAGEA WALEH|PALA|128.18117348387|0.50284';npu++;
lpu[npu]='90|KIKIM|KELAPA SAWIT|103.25428078281|-3.704398702403';npu++;
lpu[npu]='91|LABANGKA|JAGUNG|117.80123723861|-8.8196858776816';npu++;
lpu[npu]='92|PONU|PADI|124.58879757196|-9.1707109340045';npu++;
lpu[npu]='93|SALIM BATU|PADI|117.45470948271|2.8834779315911';npu++;
lpu[npu]='94|SEKAYAM - ENTIKONG|PADI|110.38422783622|0.89384052451994';npu++;
lpu[npu]='95|LEWA|PADI|119.85066961807|-9.7197930554415';npu++;
lpu[npu]='96|KODI LOURA|HORTIKULTURA (JAMBU METE)|118.99978223179|-9.4994292056146';npu++;
lpu[npu]='97|SABU|PADI|121.87074346471|-10.5417920311';npu++;
lpu[npu]='98|MBAY|KELAPA|121.26900903057|-8.6398795009265';npu++;
lpu[npu]='99|MAUKARO|HORTIKULTURA (JAMBU METE)|121.79146060003|-8.5876742094775';npu++;
lpu[npu]='100|GERBANG MASPERKASA|PADI|109.51546570703|1.684879765223';npu++;
lpu[npu]='101|BATUTUA NUSAMANUK|KACANG TANAH|122.94973160991|-10.923429036638';npu++;
lpu[npu]='102|KARANG AGUNG ILIR|PADI|104.65742702542|-2.2259526186441';npu++;
lpu[npu]='103|TALUDUTI|JAGUNG|121.68008256308|0.54557591583521';npu++;
lpu[npu]='104|PAGUYAMAN PANTAI|JAGUNG|122.53077241364|0.54100053636364';npu++;
lpu[npu]='105|ENGGANO|HORTIKULTURA (PISANG)|102.24875937745|-5.355021812709';npu++;
lpu[npu]='106|LEMBAH SABIL|KAKAO|96.921656834635|3.609667755627';npu++;
lpu[npu]='107|BABAHROT|KAKAO|96.650196297057|3.8378424918823';npu++;
lpu[npu]='108|SELAUT|KELAPA|95.81249657114|2.664403353675';npu++;
lpu[npu]='109|TAMBORA|PADI|118.13048|-8.1510278050363';npu++;
lpu[npu]='110|TUBBI TARAMANU|KAKAO|119.04295428742|-3.2421488858811';npu++;
lpu[npu]='111|KANTISA|JAGUNG|122.48931961416|-4.7596891467577';npu++;
lpu[npu]='112|BANGGAI SELATAN|PERIKANAN TANGKAP|123.11406969435|-1.8420736548152';npu++;
lpu[npu]='113|MAMBI MEHALAAN|KOPI|119.18944286758|-2.952065913';npu++;
lpu[npu]='114|BAHARI TOMINI RAYA|PADI|121.04808705367|0.48541684154672';npu++;
lpu[npu]='115|PULAU MOROTAI|PADI|128.16039848635|2.3427580067114';npu++;
lpu[npu]='116|LUNANG SILAUT|JAGUNG|101.07067743325|-2.3788901545117';npu++;
lpu[npu]='117|MESUJI|KELAPA SAWIT|105.58995911259|-4.0096456196272';npu++;
lpu[npu]='118|LAGITA|KELAPA SAWIT|101.87327881821|-3.3262542784051';npu++;
lpu[npu]='119|TELANG|PADI|104.72247050446|-2.7045111433878';npu++;
lpu[npu]='120|BELITANG|PADI|104.6507169068|-4.0018074745763';npu++;
lpu[npu]='121|PAWONSARI|JAGUNG|122.44216154046|0.7187811628131';npu++;
lpu[npu]='122|PULUBALA|PADI|122.74315446526|0.65357075631579';npu++;
lpu[npu]='123|GERBANG KAYONG|KELAPA SAWIT|109.72998173649|-1.1345717990521';npu++;
lpu[npu]='124|RASAU JAYA|PADI|109.32735570385|-0.23712177721943';npu++;
lpu[npu]='125|CAHAYA BARU|JERUK|114.67262905257|-3.0983445923979';npu++;
lpu[npu]='126|MALOY KALIORANG|KELAPA SAWIT|117.92991860616|0.9166641010263';npu++;
lpu[npu]='127|KOBISONTA|PADI|129.88774397715|-2.9495322769402';npu++;
lpu[npu]='128|LAMBOYA|PADI|119.33853300055|-9.7377717093596';npu++;
lpu[npu]='129|MELOLO|TEBU|120.62537771194|-9.9262964098361';npu++;
lpu[npu]='130|SALOR|PADI|140.19441093232|-8.162168915768';npu++;
lpu[npu]='131|TOBADAK|PADI|119.29910651528|-2.1196436256184';npu++;
lpu[npu]='132|AIR TERANG|JAGUNG|121.37694234909|1.1740864323967';npu++;
lpu[npu]='133|BUNGKU|PADI|121.77512774211|-2.3170293322872';npu++;
lpu[npu]='134|TAMPOLORE|KAKAO|120.32875365557|-1.5267362098408';npu++;
lpu[npu]='135|RAWA PITU|PADI|105.58106332697|-4.2739034179775';npu++;
lpu[npu]='136|MAHALONA|PADI|121.55261402276|-2.5953925259166';npu++;
lpu[npu]='137|BATU BETUMPANG|PADI|106.17412409296|-2.76437460505556';npu++;
lpu[npu]='138|SUBAH|PADI|109.4718885|1.25086875';npu++;
lpu[npu]='139|PARIT RAMBUTAN|KARET|104.65250797552|-3.087602212908';npu++;
lpu[npu]='140|NUSLIKU|KELAPA|127.8691974|-0.069789387643852';npu++;
//========================================================================
var GCX=0;
var GCY=0;

var GV=0;
var pdamurl="http://127.0.0.1";
     
var subdir="/sipukat.kemendesa.go.id";

var urlinfo="https://sipukat.kemendesa.go.id";
//urlinfo=pdamurl+"/sipukat.kemendesa.go.id";  //local kunjre
 pdamurl="https://sipukat.kemendesa.go.id";var subdir=""; //public
 
 

var rbi="https://portal.ina-sdi.or.id/arcgis/rest/services/RBI/Basemap/MapServer/tile/{z}/{y}/{x}";
//rbi="https://portal.ina-sdi.or.id/arcgis/rest/services/IGD/RupabumiIndonesia/MapServer/tile/{z}/{y}/{x}";

//var grbi=L.tileLayer.wms(rbi, {		
//                maxZoom: 21, 
//                minZoom: 6,        
//	});

 var grbi= L.tileLayer(rbi, {
            attribution: '',
             minZoom: 6, 
              opacity:0.5 ,
             maxZoom: 20
        });


var KU="kunmap/wms.php?";

var gKU=L.tileLayer.wms(KU, {
		layers: 'ku',
                 ds:'banaran',
                ida:0,
                format: 'image/png',
                transparent: true,
                crs: L.CRS.EPSG4326,
                maxZoom: 21, 
                opacity:1 ,
                kun:1,             
	});







 

//var submenu="<img src='"+pdamurl+"/pdam_mobile/dc.jpg'  width=25 height=25 onclick=actif_dc(); > ";
//    submenu+="&nbsp;<img src='"+pdamurl+"/pdam_mobile/area.png' width=25 height=25 onclick=freedg(); >";


var submenu1="<img src='"+pdamurl+"/dc.jpg'  width=25 height=25 onclick=actif_dc(); ><br><img src='"+urlinfo+"/cari.png'  width=25 height=25 onclick=tampilmenuku('block'); > ";
 // submenu1+="<img src='plot.png' width=25 height=25 onclick=freedg(); >";


//document.getElementsByTagName("span")[0].innerHTML=submenu1+" <div id='menuku1' style='display:none;background: #ffffff;width:200px;padding: 8px;border-radius: 6px;' > <input size=15 id=idquery  >&nbsp;<input type=button value=Do  onclick=doquery() > <input type=button value='X' onclick=tampilmenuku('none');> <span style='display:none'  id=resultquery > </span> </div>";
document.getElementsByTagName("span")[0].innerHTML=submenu1+" <div id='menuku1' style='display:none;background: #ffffff;width:200px;padding: 8px;border-radius: 6px;' ><select id=pilC style='width:150px' >  <option value=1 >Kawasan Tranmigrasi </option><option value=2 >Komoditas Unggulan</option> </select > <input type=button value='X'  style='width:40px'  onclick=tampilmenuku('none');> <br>  <input style='width:145px' id=idquery  >&nbsp;<input type=button value=Do  onclick=doquery()  style='width:40px' >  <span style='display:none'  id=resultquery > </span> </div>";




document.getElementsByTagName("span")[0].style.left='50px';
document.getElementsByTagName("span")[0].style.width='30px';



function tabs(a1)
{
 for(j=0;j<12;j++)
 {
   document.getElementById('tab'+j).style.color='#00f';
   document.getElementById('tab'+j).style.background='#fff';
   //document.getElementById('tab'+j).style.font-size='13px';

   document.getElementById('tabi'+j).style.display='none';
 }
      document.getElementById('tabi'+a1).style.display='block';
      
   document.getElementById('tab'+a1).style.color='#fff';
   document.getElementById('tab'+a1).style.background='#000';
   //document.getElementById('tab'+a1).style.font-size='16px';


}

var plot2=0;
function freedg()
{

 //jg_n==0;
 //var s2="<span id=msggps ></span><span id=msggps2 ></span>";
    
 // document.getElementById("resultquery").innerHTML=s2; 
 // document.getElementById("resultquery").style.display='block'; 
 //doDrw();
 if(plot2==0)
 {
  document.getElementById("myCanvas").style.display='block';plot2=1;
 }else
{
   document.getElementById("myCanvas").style.display='none';plot2=0;

}
}

function doplot()
{
 sx=(map.getBounds().getEast()+map.getBounds().getWest())/2;sy=(map.getBounds().getNorth()+map.getBounds().getSouth())/2;

  $.post("doplot.php",{x:sx,y:sy},function(data){
        //alert(data);
       if(data>"")
       {
                         popup
                       .setLatLng([sy,sx])
                       .setContent('<b>PROFILE TRANSMIGRAN</b><hr>'+data)
                       .openOn(map); 
        }
      

   });
}
 document.getElementsByTagName("div")[1].innerHTML=" <input type=button value='Info-Akses' onclick=rekaps()>";

var myCan= document.getElementById("myCanvas");
document.getElementsByTagName("div")[3].style.display='none';
document.getElementsByTagName("div")[3].innerHTML="<img src='"+pdamurl+"/pdam_mobile/t.png' width=40 height=40 onclick=doplot(); >";

//alert(myCanvas.innerHTML);

myCan.style.left= $('#map').width()/2 -20  +'px'; 
myCan.style.top= $('#map').height()/2 -18  +'px'; 
 
myCan.style.width='20px';
myCan.style.height='20px';
//myCan.style.zIndex = 9900;
//myCan.style.display='block';


//alert(document.getElementById('map').zIndex);

//alert(document.getElementsByTagName("div")[3].innerHTML);


//document.getElementsByTagName("span")[0].style.display='none';


var pMark=Array();
var nMark=0;

var gpssiap=0;

function onErrorGPS()
{

}

var vSel=Array();
var nSel=-1;

function tarikGrs(y1,x1)
{
if(nSel>-1)
{
   var pol2=Array();
  vSel[nSel]=[y1,x1];nSel++;s3='';
   for(k=0;k<nSel;k++)
  {
    pol2[k]=vSel[k];
    if(k>0){s3+=';';}
    s3+=vSel[k][1]+','+vSel[k][0];
  }
  if(nSel>1)
  {
    if(document.getElementById('radio1').checked){ pol2[nSel]=pol2[0];}
    var marker2 = L.polyline(pol2);

         gpsLayer.clearLayers();
         gpsLayer.addLayer(marker2);
         map.addLayer(gpsLayer);
  }
  
 document.getElementById('dataPlt').value=s3;
  
} 

}


function doPlt()
{
 var marker4 = new  L.circle([GCY,GCX ],3, {
		color: '#00FF00',
		fillColor: '#00FF00',
		fillOpacity: 0.1

               

	      });//
    var x2=GCX;
    var y2 =GCY;
   marker4.on("click", function() { tarikGrs(y2,x2); } ); 

//var marker4 = new L.marker([GCY,GCX], { opacity: 0.01 }); //opacity may be set to zero
//marker4.bindTooltip("OK", {permanent: true, offset: [0, 0] });


 					
 					plotLayer.addLayer(marker4);
 					map.addLayer(plotLayer);
}

function gerakGPS()
{
  markersLayer.clearLayers();

 var z= 110000*(map.getBounds().getEast() - map.getBounds().getWest());
                 var w=  $(document).width();  
  var r=(2/w)*z;
   var marker4 = new  L.circle([GCY,GCX ],1, {
		color: '#FF0000',
		fillColor: '#FF0000',
		fillOpacity: 0.1

               

	      });//
 					
 					markersLayer.addLayer(marker4);
 					map.addLayer(markersLayer);


}


function pusatkan()
{
 if(GCX>0)
 {
  map.setView([GCY,GCX],map.getZoom());  gerakGPS();
 }
}
function handleGetCurrentPosition(location){
 //if(gpssiap==1)
 {
  // gpssiap=0;
  GCX=location.coords.longitude;
  GCY=location.coords.latitude;
    //map.setView([location.coords.latitude,location.coords.longitude],15);
    //xsing=location.coords.longitude;
    //ysing=location.coords.latitude;
// document.getElementById('kun_speed').innerHTML= location.coords.speed;
 // document.getElementById('kun_timestamp').innerHTML=  location.timestamp ;
  //document.getElementById('kun_altitude').innerHTML=  location.coords.altitude;
  //  document.getElementById('kun_accuracy').innerHTML=  location.coords.accuracy;
  // document.getElementById('kun_longitude').innerHTML=  GCX; //.substr(0, 12); // location.coords.longitude;
 //  document.getElementById('kun_latitude').innerHTML=   GCY; //.substr(0, 12); //location.coords.latitude);
  
 // document.getElementById('kun_altitudeAccuracy').innerHTML=  location.coords.altitudeAccuracy;
  
 //  document.getElementById('kun_heading').innerHTML=  location.coords.heading;
  
  //  document.getElementById('msggps').innerHTML="";
  //  document.getElementById('papangps').style.display='block';
   gerakGPS();
   map.setView([GCY,GCX],18);
 }
}

function refresh()
{
n1++;
 var url2=pdamurl+"/mesuji/bng.php?tl=1&bg=0&x={x}&y={y}&z={z}&map=bng&v=a"+n1;
 bng.setUrl(url2);
}
function doUpd()
{
 var bts=nSel;
  if(document.getElementById('radio1').checked){bts=nSel-1;}
if(bts >1)
{
  var dt2=document.getElementById('dataPlt').value;
  var id2=document.getElementById('dataId').value;
  var tp2=1;
    if(document.getElementById('radio1').checked){tp2=0;}
// alert (dt2 +'|'+kd2+'|'+tp2);

  $.post(pdamurl+"/mesuji/add.php", { dt2: dt2, id2: id2 ,tp2:tp2 }, function(data){

             
            if(data>"")
            {
                 gpsLayer.clearLayers();
                doClr();
                refresh();  
                nData++;
                document.getElementById('dataId').value=n1;           
            } 
             
        }).fail(function() {
         
            
           
             alert('gagal');
             
        });

}else {alert ('koordinat kurang');}
}

function doClr()
{
 nSel=0;
 document.getElementById('dataPlt').value='';
  gpsLayer.clearLayers();
}
var nData=0;
function doDrw()
{ nData++;
  var s3="<input type='radio' id='radio1' name='radios' value='0' checked  >Area &nbsp;&nbsp<input   name='radios' type='radio' id='radio2' value='1'>Poline";
   s3+="  <br><textarea id=dataPlt style='width:200px;display:none'   ></textarea><br>";
   s3+="Id Obyek <input id=dataId style='width:100px'  value="+ n1 +" ><br>";
   s3+="<input type=button value=Clear onclick=doClr(); > &nbsp; <input type=Button value=Upload onclick=doUpd() > ";
   s3+=" &nbsp; <input type=Button value=Cancel onclick=doCC() >";
  document.getElementById('msggps2').innerHTML=s3;nSel=0;
  refresh();  
}


function doCC()
{
 doClr()
 nSel=-1;
 //alert(  document.getElementById('radio1').checked  );
 document.getElementById('msggps2').innerHTML="";
  document.getElementById('myCanvas').style.display="none";

}
function gpson()
{
  //if(gpssiap==1)
  {
     if(navigator.geolocation)
       { navigator.geolocation.getCurrentPosition(handleGetCurrentPosition, onErrorGPS);}
    //setTimeout("gpson()",2000);
  }
} 

function doCls()
{
  gpssiap=0;
  document.getElementById("resultquery").innerHTML="";
  document.getElementById("myCanvas").style.display="none";
}
function actif_dc()
{

    //alert('Latitude: '          + position.coords.latitude          + '\n' +
    //      'Longitude: '         + position.coords.longitude         + '\n' +
   //       'Altitude: '          + position.coords.altitude          + '\n' +
    //      'Accuracy: '          + position.coords.accuracy          + '\n' +
      //    'Altitude Accuracy: ' + position.coords.altitudeAccuracy  + '\n' +
       //   'Heading: '           + position.coords.heading           + '\n' +
       //   'Speed: '             + position.coords.speed             + '\n' +
      //    'Timestamp: '         + new Date(position.timestamp)      + '\n');
 var s2="<hr><table>";
     s2+="<tr><td>Longitude</td><td><span id=kun_longitude > -</span></td></tr>";
s2+="<tr><td>Latitude</td><td><span id=kun_latitude > -</span></td></tr>";
     s2+="<tr><td>Altitude</td><td><span id=kun_altitude >-</span></td></tr>";
     s2+="<tr><td>Accuracy</td><td><span id=kun_accuracy  >- </td></tr>";
   //  s2+="<tr><td>Altitude Accuracy</td><td><span id=kun_altitudeAccuracy  > -</span></td></tr>";
  //   s2+="<tr><td>Heading</td><td><span id=kun_heading  >-</span> </td></tr>";
  //   s2+="<tr><td>Speed</td><td><span id=kun_speed  >0</span></td></tr>";
  //    s2+="<tr><td>Timestamp</td><td><span id=kun_timestamp  >00/00/000</span></td></tr>";
        s2+="</table><div id=papangps style='display:none' > <br><input type=button value='Re-Ctr' onclick=pusatkan(); >&nbsp;<input type=button value=Plot onclick=doPlt();> ";
        s2+="&nbsp;<input type=button value=Draw onclick=doDrw();> ";
        s2+="&nbsp;<input type=button value=Close onclick=doCls();>  </div> <span id=msggps >Tunggu.....</span><span id=msggps2 ></span>";
    
//  document.getElementById("resultquery").innerHTML=s2;  
//  document.getElementById("resultquery").style.display='block';
//  GV++;

//  gpssiap=1;GCX=0;
   setTimeout("gpson()",10);  
}

var mp4="https://geofisunnes.com/bigmap/map.php?tl=1&bg=0&x={x}&y={y}&z={z}&map=desabig&v=4";

  var desaInd=L.tileLayer(mp4,{opacity:1,maxZoom:22});      

 

 var jagungIcon = L.icon({
        iconUrl: urlinfo+'/jagung.png',
        iconSize: [50,50], 
        
        });

 var sapiIcon = L.icon({
        iconUrl: urlinfo+'/sapi.png',
        iconSize: [50,50], // size of the icon
        });

 var kopiIcon = L.icon({
        iconUrl: urlinfo+'/kopi.png',
        iconSize: [50,50], // size of the icon
        });

 var kakauIcon = L.icon({
        iconUrl: urlinfo+'/kakao.png',
        iconSize: [50,50], // size of the icon
        });



 var potIcon = L.icon({
        iconUrl: urlinfo+'/potensi.png',
        iconSize: [50,50], // size of the icon
        });

var padiIcon = L.icon({
        iconUrl: urlinfo+'/padi.png',
        iconSize: [50,50], // size of the icon
        });
var jerukIcon = L.icon({
        iconUrl: urlinfo+'/jeruk.png',
        iconSize: [50,50], // size of the icon
        });
var karetIcon = L.icon({
        iconUrl: urlinfo+'/karet.png',
        iconSize: [50,50], // size of the icon
        });
var ksIcon = L.icon({
        iconUrl:urlinfo+ '/sawit.png',
        iconSize: [50,50], // size of the icon
        });

var vaniliIcon = L.icon({
        iconUrl: urlinfo+'/vanili.png',
        iconSize: [50,50], // size of the icon
        });

var kemiriIcon = L.icon({
        iconUrl: urlinfo+'/kemiri.png',
        iconSize: [50,50], // size of the icon
        });
var meteIcon = L.icon({
        iconUrl: urlinfo+'/mete.png',
        iconSize: [50,50], // size of the icon
        });

var ikanIcon = L.icon({
        iconUrl: urlinfo+'/ikan.png',
        iconSize: [50,50], 
        });
var pisangIcon = L.icon({
        iconUrl: urlinfo+'/pisang.png',
        iconSize: [50,50], 
        });


var palaIcon = L.icon({
        iconUrl: urlinfo+'/pala.png',
        iconSize: [50,50], 
        });

var kelapaIcon = L.icon({
        iconUrl: urlinfo+'/kelapa.png',
        iconSize: [50,50], 
        });

var saguIcon = L.icon({
        iconUrl: urlinfo+'/sagu.png',
        iconSize: [50,50], 
        });

var ladaIcon = L.icon({
        iconUrl: urlinfo+'/lada.png',
        iconSize: [50,50], 
        });


var tebuIcon = L.icon({
        iconUrl: urlinfo+'/tebu.png',
        iconSize: [50,50], 
        });
var kacangpanjangIcon = L.icon({
        iconUrl: urlinfo+'/kacangpanjang.png',
        iconSize: [50,50], 
        });

var kacangIcon = L.icon({
        iconUrl: urlinfo+'/kacang.png',
        iconSize: [50,50], 
        });


var cengkehIcon = L.icon({
        iconUrl: urlinfo+'/cengkeh.png',
        iconSize: [50,50], 
        });


var saguIcon = L.icon({
        iconUrl: urlinfo+'/sagu.png',
        iconSize: [50,50], 
        });

var wisataIcon = L.icon({
        iconUrl: urlinfo+'/wisata.png',
        iconSize: [25, 25], 
        });


var iptIcon = L.icon({
        iconUrl: urlinfo+'/IPT.png',
        iconSize: [25, 25], 
        });





//var movieList=apiUrl+"/wabz/guide.php?start=";
                var prm=pdamurl+subdir+"/map.php?tl=0&bg=0&x={x}&y={y}&z={z}&map=prm&v=2";//+n1;
               var kunbg1="https://a.tile.openstreetmap.org/{z}/{x}/{y}.png";
         var kunbg2="https://google.hk/maps/vt?lyrs=s@189&gl=cn&x={x}&y={y}&z={z}";
         var Hutan=pdamurl+subdir+"/kh.php?v=1&x={x}&y={y}&z={z}";
         var Drn=pdamurl+subdir+"/drnpng.php?v=2&x={x}&y={y}&z={z}";
            // Drn="https://mappa.id/main/ortho/all/{x}/{y}/{z}";
            //  Drn="https://petadasar.atrbpn.go.id/wms/?d={x}/{y}/{z}";

              var Topografi="https://tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png";
              
              var Lapan="http://spacemap.lapan.go.id/erdas-iws/ogc/wms/indonesia_medres?";

         var Prov=pdamurl+subdir+"/prov/Z{z}/{y}/{x}.png";


         var kunbg3=pdamurl+"/bigmap/bg.php?bg=1&x={x}&y={y}&z={z}&v="+GV;
  var kunBG=kunbg3;

         var kunlayer=pdamurl+subdir+"/map.php?tl=0&bg=0&x={x}&y={y}&z={z}&map=kws_6&v=1.9";//&v="+n1;
         
         var kunhpl=pdamurl+subdir+"/map.php?tl=0&bg=0&x={x}&y={y}&z={z}&map=hpl_6&v=2204";//&v="+n1;
         var kunkp=pdamurl+subdir+"/map.php?tl=0&bg=0&x={x}&y={y}&z={z}&map=kp_6&v=1.2";//&v="+n1;



         var potensi=pdamurl+subdir+"/map.php?tl=0&bg=0&x={x}&y={y}&z={z}&map=potensi&v=22";//&v="+n1;

         var rskp=pdamurl+subdir+"/map.php?tl=0&bg=0&x={x}&y={y}&z={z}&map=rskp&v=220304";//+n1;
         var rtsp=pdamurl+subdir+"/map.php?tl=0&bg=0&x={x}&y={y}&z={z}&map=rtsp&v=222008";//+n1;
                  
                  var uptbina=pdamurl+subdir+"/map.php?tl=0&bg=0&x={x}&y={y}&z={z}&map=sp&v=2";//+n1;
                  
                   var ljalan=pdamurl+subdir+"/map.php?tl=0&bg=0&x={x}&y={y}&z={z}&map=jln&v=2";//+n1;

        var skp=pdamurl+subdir+"/map.php?tl=1&bg=0&x={x}&y={y}&z={z}&map=skp&v=2";//+n1;
       
            
         var klikpeta="https://139.59.234.182/klikpeta_poi_tiles/{z}/{x}/{y}.png";
       //   var Drone=pdamurl+"/mesuji/Z{z}/{y}/{x}.jpg";

  var IW="https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}";
   var LB="https://server.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}";
       
         var gs="https://mt0.googleapis.com/vt?lyrs=m@267000000&src=apiv3&hl=en-US&x={x}&y={y}&z={z}&style=50,37%7Csmartmaps";

	function currencyFormat(num) {
  return  num.toFixed(5).replace(/(\d)(?=(\d{6})+(?!\d))/g, '$1,')
}

var xsing=110.881090259; var ysing=-6.80826565004;
  xsing=117.8 ;ysing=-3;
 function infopos(x,y)
{
$("#koordku").html( currencyFormat(x) +"  "+currencyFormat(y));
}
	
        var markersLayer = new L.LayerGroup();  
        var gpsLayer = new L.LayerGroup();   
        var plotLayer = new L.LayerGroup();     

        var 
            sat_image= L.tileLayer(kunBG, {
            attribution: '', 
            opacity: 0.99,            
             maxZoom: 21
        });


//http://mesonet.agron.iastate.edu/cgi-bin/wms/nexrad/n0r.cgi?service=WMS&request=GetMap&layers=nexrad-n0r-900913&styles=&format=image%2Fpng&transparent=true&version=1.1.1&EPSG=3395&width=256&height=256&srs=EPSG%3A3857&bbox=12523442.714243278,-1252344.2714243263,13775786.985667607,0
//http://mesonet.agron.iastate.edu/cgi-bin/wms/nexrad/n0r.cgi?service=WMS&request=GetMap&layers=nexrad-n0r-900913&styles=&format=image%2Fpng&transparent=true&version=1.1.1&EPSG=4326&width=256&height=256&srs=EPSG%3A3857&bbox=10018754.171394622,0,11271098.44281895,1252344.2714243277
//http://mesonet.agron.iastate.edu/cgi-bin/wms/nexrad/n0r.cgi?service=WMS&request=GetMap&layers=nexrad-n0r-900913&styles=&format=image%2Fpng&transparent=true&version=1.1.1&width=256&height=256&srs=EPSG%3A3857&bbox=12523442.714243278,-1252344.2714243263,13775786.985667607,0
//var nexrad = L.tileLayer.wms("http://mesonet.agron.iastate.edu/cgi-bin/wms/nexrad/n0r.cgi", {
//    layers: 'nexrad-n0r-900913',
//    format: 'image/png',
    
 //   transparent: true,
 // EPSG:4326,
//});

 const LeafIcon = L.Icon.extend({
		options: {
			
			iconSize:     [15, 20]
		}
	});
         const bnpbIcon= new LeafIcon({iconUrl: 'https://inarisk.bnpb.go.id/webgis/img/laporan_hari_ini.png'});
 

var m1='http://127.0.0.1/ip4t.online/kunmap/wms.php';


var nexrad=L.tileLayer.wms(m1, {
		layers: 'batas',
                 ds:'banaran',
                ida:0,
                format: 'image/png',
                transparent: true,
                crs: L.CRS.EPSG4326,
                maxZoom: 21, 
                opacity:1              
	});




 var pu_marker = new L.LayerGroup();
 var bnpb_marker = new L.LayerGroup();
 
  var ico2=  "mete";
 for (j = 0; j < npu; j++) {
    var s=lpu[j].split("|");var y3=s[4]*1;var x3=s[3]*1;ico2="kakao";
    var iconnya=potIcon; if(s[2]=='JAGUNG'){iconnya=jagungIcon;ico2="jagung";}
     if(s[2]=='PADI'){iconnya=padiIcon;ico2="padi";}if(s[2]=='PETERNAKAN'){iconnya=sapiIcon;ico2="sapi";}

      if(s[2]=='HORTIKULTURA (JAMBU METE)'){iconnya=meteIcon;ico2="mete";}
      if(s[2]=='HORTIKULTURA (PISANG)'){iconnya=pisangIcon;ico2="pisang";}
      if(s[2]=='PERIKANAN BUDIDAYA'){iconnya=ikanIcon;ico2="ikan";}
      if(s[2]=='PERIKANAN TANGKAP'){iconnya=ikanIcon;ico2="ikan";}
  if(s[2]=='KELAPA'){iconnya=kelapaIcon;ico2="kelapa";}
  if(s[2]=='PALA'){iconnya=palaIcon;ico2="pala";}

  if(s[2]=='TEBU'){iconnya=tebuIcon;ico2="tebu";}
  if(s[2]=='CENGKEH'){iconnya=cengkehIcon;ico2="cengkeh";}
  if(s[2]=='SAGU'){iconnya=saguIcon;ico2="sagu";}
  if(s[2]=='LADA'){iconnya=ladaIcon;ico2="lada";}

  if(s[2]=='JERUK'){iconnya=jerukIcon;ico2="jeruk";}

  if(s[2]=='KACANG TANAH'){iconnya=kacangIcon;ico2="kacang";}
 



    if(s[2]=='KOPI'){iconnya=kopiIcon;ico2="kopi";}if(s[2]=='KAKAO'){iconnya=kakauIcon;ico2="kakao";}
    if(s[2]=='VANILI'){iconnya=vaniliIcon;ico2="vanili";}if(s[2]=='KEMIRI'){iconnya=kemiriIcon;ico2="kemiri";}


     if(s[2]=='KELAPA SAWIT'){iconnya=ksIcon;ico2="kelapasawit";} if(s[2]=='KARET'){iconnya=karetIcon;ico2="karet";}
    marker9 = L.marker([y3,x3],{icon: iconnya,maxZoom:21,minZoom:10});
     marker9.bindPopup('<p> ' + s[1] + ' <hr><br> KOMODITAS UNGGULAN:<br> ' + s[2]+' </p><img src=' +ico2 +'.png width=50 height=50 >').openPopup();

  //     marker9.on('click', function(e) {
           

//            markersLayer.clearLayers();

//                 var z= (map.getBounds().getEast() - map.getBounds().getWest());
  //               var w=  $(document).width();
    //             var rr=z*110000*(11/w);
                

	//        var marker4 = new  L.circle([e.latlng.lat,e.latlng.lng ],rr, {
	//	color: '#FF0000',
	  //    });
 	//				
 	//				markersLayer.addLayer(marker4);
 	//				map.addLayer(markersLayer);


      // });
     pu_marker.addLayer(marker9);


 }  
 

 var url ="https://inarisk.bnpb.go.id:444/dashboardkegiatan/data/lapor_kejadian_get_json.php" 


   $.post(url, function(data, status){
    if(data >"")
    {
       var n=data.features.length;
         var x;
         var y;
        
        for(j=0;j<n;j++)
        {
          x=data.features[j].geometry.coordinates[0];
          y=data.features[j].geometry.coordinates[1];
          ket="<table>";
          ket+="<tr><td>Kegiatan</td><td> : "+data.features[j].properties.kegiatan+"</td></tr>";
          ket+="<tr><td>Tanggal</td><td> : "+data.features[j].properties.tgl+"</td></tr>";
          ket+="<tr><td>Lokasi</td><td> : "+data.features[j].properties.lokasi+"</td></tr>";
          ket+="<tr><td>Organisasi</td><td> : "+data.features[j].properties.organisasi+"</td></tr>";
         ket+="<tr><td>User Pemantau</td><td> : "+data.features[j].properties.user_pemantau+"</td></tr>";
         ket+="<tr><td>Deskripsi</td><td> : "+data.features[j].properties.deskripsi+"</td></tr>";
                ft2=data.features[j].properties.foto.toString();
                ft=ft2.split(",");
                  ket+="<tr><td>foto</td><td> : <img src='"+ft[0]+"' width=100px  ></td></tr>";
          ket+="</table>";
          const mRed = L.marker([y,x], {icon: bnpbIcon}).bindPopup(ket);//.addTo(map);
           bnpb_marker.addLayer(mRed);
           data.features[j]=null;
        }
       // alert(x+','+y);
    }
  });
 
 

 //var pu_marker = L.marker([-6.64701, 106], {icon: kebunIcon});

// pu_marker.bindPopup('<p>You are here ' + '</p>').openPopup();

 var 
            gTopografi= L.tileLayer(Topografi, {
            attribution: '',            
             maxZoom: 21
        });
        
     var gLapan2=L.tileLayer.wms(Lapan,{layers:'LPN_LS8_MS_20190101-20190630_MOS-PB_IDN.ecw',tiled:true,format:'image/png',transparent:true,crs:L.CRS.EPSG3857,maxZoom:21});
       
        gLapan=L.tileLayer.wms('http://spacemap.lapan.go.id/erdas-iws/ogc/wms/indonesia_medres', {
                    layers: 'LPN_LS8_MS_20190101-20190630_MOS-PB_IDN.ecw',
                    format: 'image/png',
                    transparent: 'true',
                    version: '1.3.0',
                    attribution: ''
                    });

               var sat_IW= L.tileLayer(IW, {
            attribution: '',          
             maxZoom: 21
        });
       
               var sat_LB= L.tileLayer(LB, {
            attribution: '',          
             maxZoom: 20
        });
       



         var gg= L.tileLayer(kunbg2, {
            attribution: '',
             maxZoom: 21
        });

       

    //    var gHutan= L.tileLayer(Hutan, {
    //        attribution: '',
    //         maxZoom: 12,
    //         minZoom:6
    //    });
        
 //       var L2="https://sigap.menlhk.go.id/proxy/proxy.php?https://sigap.menlhk.go.id/server/rest/services/KLHK/B_Kawasan_Hutan/MapServer/export?";
//var gHutan=L.tileLayer.wms(L2,
//  {layers:'show:0',tiled:true,format:'image/png',transparent:true,
//   attribution: "",
//  crs:L.CRS.EPSG3857,maxZoom:21,minZoom:5,opacity:0.95,tileSize: 512,f:'image'});  
  
  var Hutan="https://sigap.menlhk.go.id/server/rest/services/KLHK/B_Kawasan_Hutan/MapServer/tile/{z}/{y}/{x}?blankTile=false";
  
  Hutan="https://geoportal.menlhk.go.id/server/rest/services/SIGAP_Interaktif/Kawasan_Hutan/MapServer/tile/{z}/{y}/{x}";
      var gHutan= L.tileLayer(Hutan, {
            attribution: '',
             maxZoom: 12,
             minZoom:6
        });
        
        
        
var Prukades=pdamurl+subdir+"/map.php?tl=0&bg=0&x={x}&y={y}&z={z}&map=point_prukades_1&v=1";//+n1;

                var gPrukades= L.tileLayer(Prukades, {
            attribution: '',
             maxZoom: 21,
             minZoom:5
        });
         var Bumdes=pdamurl+subdir+"/map.php?tl=0&bg=0&x={x}&y={y}&z={z}&map=point_bumdes_2&v=1";//+n1;

               var gBumdes= L.tileLayer(Bumdes, {
            attribution: '',
             maxZoom: 21,
             minZoom:5
        });

         var Wisata=pdamurl+subdir+"/map.php?tl=0&bg=0&x={x}&y={y}&z={z}&map=point_wisata_3&v=1";//+n1;

               var gWisata= L.tileLayer(Wisata, {
            attribution: '',
             maxZoom: 21,
             minZoom:4
        });




        var gDrn= L.tileLayer(Drn, {
            attribution: '',
             maxZoom: 21,
             minZoom: 10
        });

        var gProv= L.tileLayer(Prov, {
            attribution: '',
             maxZoom: 5,
             minZoom:3
        });

        var gPot= L.tileLayer(potensi, {
            attribution: '',
             maxZoom: 18,
             minZoom:4
        });
        
        var guptbina= L.tileLayer(uptbina, {
            attribution: '',
             maxZoom: 18,
             minZoom:4
        });
         var gjalan= L.tileLayer(ljalan, {
            attribution: '',
             maxZoom: 21,
             minZoom:5
        });

        var grskp= L.tileLayer(rskp, {
            attribution: '',
             maxZoom: 18,
             minZoom:4
        });//minzoom 10
         var gprm= L.tileLayer(prm, {
            attribution: '',
             maxZoom: 18,
             minZoom:4
        });//minzoom 10
        var grtsp= L.tileLayer(rtsp, {
            attribution: '',
             maxZoom: 18,
             minZoom:4
        }); //minzop 10


         var gskp= L.tileLayer(skp, {
            attribution: '',
             maxZoom: 17,
             minZoom:4
        });



       var gg2= L.tileLayer(klikpeta, {
            attribution: '',
            opacity: 0.6,
             maxZoom: 21
        });
       var gg3= L.tileLayer(gs, {
            attribution: '',
             maxZoom: 21
        });

	
	
          var amfm=L.tileLayer(kunlayer,{opacity:1,maxZoom:21,minZoom:6});
          
                    var amhpl=L.tileLayer(kunhpl,{opacity:1,maxZoom:21,minZoom:4});
      var amkp=L.tileLayer(kunkp,{opacity:1,maxZoom:21,minZoom:6});
                        

    
     var w212=$( document ).width();
          var W313=Math.round((w212/1300)*5); 	
       
          
     var map = L.map('map', {
		center: [ysing,xsing],
                 attribution: '',
		zoom: W313,                 
                 minZoom:4,
                 maxZoom:21,
		layers: [gg,gg3,gProv,amfm   ] 
	});

        var baseLayers = {
                  "Google Image":gg,
                  // "Word Image":sat_IW,
		 
                  
                
               
                
	};


//gwisata

//

var gIpt= new L.LayerGroup(); 


$.post(urlinfo+'/ipt.php', {d:1}, function(data){

 if(data>"")
{
  var isi="";var ds;
 var obj = data.split('[]');

 var n=obj.length;
  var mw=0;
 
  if(n>1)
  {
   
  // var dt=JSON.parse(obj.dt);

    for(j=0;j<n;j++)
    {
    
     
      var ob=obj[j];
      if(ob>" ")
     {
      var dt=ob.split("|");
        if(j==0)
        {
          ds=dt;
        } else
        {
     
         marker9 = L.marker([(dt[3]*1),(dt[2]*1)],{icon:iptIcon,maxZoom:21,minZoom:10});
          isi="<table ><tr><td colspan=2 align=center ><b>Info IPT</b></td></tr>";
           isi+="<tr><td bgcolor='#ddd' >"+ds[1]+"</td><td  bgcolor='#eee'>"+dt[1]+"</td></tr>";
              for(k=4;k<20;k++) {
              isi+="<tr><td bgcolor='#ddd' >"+ds[k]+"</td><td bgcolor='#eee'>"+dt[k]+"</td></tr>";
               }
          isi+="</table>";
         marker9.bindPopup( isi ).openPopup();
      
        gIpt.addLayer(marker9);
       }
    }
    
    }
   
  }
 }

});








	var overlays = {
	           "LAPAN":gLapan,
                "RupaBumiIndonesia":grbi,
                "Peta Drone":gDrn,
                "Kawasan Hutan":gHutan,
                "Google Street":gg3,
		"Provinsi": gProv, 
                  "Potensi Kawasan":gPot,         
		"Kawasan Trans.": amfm,
                 "SKP":gskp,
                 "RSKP":grskp,
                 "RTSP":grtsp,
                  "IPT":gIpt, 
                  "Prukades":gPrukades,
                  "Bumdes":gBumdes,
                 "Komoditas Unggulan":pu_marker,
                 "Lokasi Wisata":gWisata,
                 "HPL Trans": amhpl,
                "Kaw. Trans Desa": amkp,
                 "Batas Desa": desaInd,
                "Satuan Pemukiman": guptbina,
                "Jalan":gjalan,
                "inaRISK":bnpb_marker,
                "Perwujudan Ruang":gprm,
                

	};

	L.control.layers(baseLayers, overlays).addTo(map);


   var marker2 = L.polygon([
		[-7.42515,109.23135],
		[-7.42515,109.25135],
		[-7.45515,109.23135]
	]);

         markersLayer.addLayer(marker2);  
         gpsLayer.addLayer(marker2);
         //map.addLayer(markersLayer);

if(kunx==0) 
 {
         map.fitBounds([ [7, 141],  [-12,94] ])
  } else
{
  
  map.setView([kuny,kunx],11);
  $('.leaflet-control-layers-selector')[2].click();
  $('.leaflet-control-layers-selector')[3].click();
}


  function onZoomend() {
    var cZ = map.getZoom();//alert(cZ);
    var mC=map.getCenter();
    
 };




map.on('zoomend', onZoomend);

map.on('dragend', function onDragEnd(){
    var width = map.getBounds().getEast() - map.getBounds().getWest();
    var height = map.getBounds().getNorth() - map.getBounds().getSouth();

   
 });


var popup = L.popup();


function showtagihan(id2)
{
  var nosmb= document.getElementById("cur_nosmb").innerHTML;
 document.getElementById("isitagihan").innerHTML='tungdu akses data '+ nosmb + ' ...';  
 //  $.post('http://mdms.wonosobo.pass-pdam.com/tagihan.php', { nosmb: 01141500, y: 1 }, function(data){
  //     alert(data);
  //  if(data>"") {


//}

//     }).fail(function() {  document.getElementById("isitagihan").innerHTML="Gagal akses ";   });

} 

function klikdesa(x,y)
{

                 var z= (map.getBounds().getEast() - map.getBounds().getWest());
                 var w=  $(document).width();                             
                 var mz= map.getZoom();
$.post('https://kunmap.net/bigmap/info.php', { x: x, y: y,z: z, w:w ,mz:mz }, function(data){

             markersLayer.clearLayers();
   
            if(data>"")
            {
                
               var obj = JSON.parse(data);
                 
                 if(obj.isi>"") {
                  popup
                       .setLatLng([y,x])
                       .setContent('<b>'+obj.judul+'</b><hr>'+obj.isi)
                       .openOn(map); 
                          var z1=z/10; 
                     var x1=x ; var y1=y; var x2=x+z1; var y2=y;var x3=x;var y3=y-z1;

                     
                      var marker4 = new   L.polygon(JSON.parse(obj.pol));
 					
 					markersLayer.addLayer(marker4);
 					map.addLayer(markersLayer);
                     
                      }
               
            } 
             
        }).fail(function() {
         
            
           
            // alert('gagal');
             
        });


   	              

}

var cur_x=0;
var cur_y=0;

function infoHPL(obj,mz)
{
	
                 
     	if(obj.pol =="OKE") 
	{
                   
                cur_x=obj.x;xur_y=obj.y;
                popup
                       .setLatLng([obj.y,obj.x])
                       .setContent('<b><h2>'+mz+'</h2></b>'+obj.isi)
                       .openOn(map);      

                   
   	}               
}



function infoSK(obj,mz)
{
	
                 
     	if(obj.pol =="OKE") 
	{
                   
        	if(mz<9)
                {
                   	var bts=obj.batas;bts=bts.split(" ");
              		x1=bts[0]*1;y1=bts[1]*1;x2=bts[2]*1;y2=bts[3]*1;
            		map.fitBounds([
            		[y2, x1],
           		[y1,x2]
           		])
                } 
                cur_x=obj.x;xur_y=obj.y;
                popup
                       .setLatLng([obj.y,obj.x])
                       .setContent('<b>'+obj.judul+'</b>'+obj.isi)
                       .openOn(map); 
                 

                 if(obj.docs>'')
                {
                    loaddocs(obj.docs);
                }
                if(obj.sinergitasKL>'')
                {
                    loadsinergitasKL(obj.sinergitasKL);
                }
                if(obj.kpb8>''){loadkpb(obj.kpb8,8);}
                if(obj.kpb9>''){loadkpb(obj.kpb9,9);}
                if(obj.kpb10>''){loadkpb(obj.kpb10,10);}
                if(obj.kpb11>''){loadkpb(obj.kpb11,11);}
                 isiaksesnya(obj.kunci);
                   
   	}               
}

function isiaksesnya(k)
{
 document.getElementById('isiakses').innerHTML="";
 $.post(urlinfo+'/akses.php', { d:k }, function(data){
     
    if(data>"")
     
            {
               document.getElementById('isiakses').innerHTML=data;
            }
      
   } );
}

function loadkpb(ddd,i)
{
   document.getElementById('tabi'+i).innerHTML="Tunggu...";
   $.post(urlinfo+'/kpb'+i+ '.php', { d:ddd }, function(data){
    if(data>"")
     
            {
               document.getElementById('tabi'+i).innerHTML=data;
            }
      
   } );
}
               

function infoke2(obj,mz)
{
                   if(obj.isi>"")
                 {
                   popup
                       .setLatLng([obj.y,obj.x])
                       .setContent('<b>'+obj.judul+'</b>'+obj.isi)
                       .openOn(map); 
                 }
               if(obj.pol>"")
               {
                  if(mz==100)
                    {
                       var marker4 = new   L.polyline(JSON.parse(obj.pol));
                      } else
                  {
                  var marker4 = new   L.polygon(JSON.parse(obj.pol));
                  }
 					
 		  markersLayer.addLayer(marker4);
 		  map.addLayer(markersLayer);
               }
             
            
    
 
}  



map.on("click",function(e){
         var data="";
         var y=e.latlng.lat;var x=e.latlng.lng; 
           infopos(x,y); 

                var z= (map.getBounds().getEast() - map.getBounds().getWest());
                 var w=  $(document).width();                             
                 var mz= map.getZoom();
                 var lewat=0;
    




var idLA=Array(23,20,16,14,13,11,10,9,7,17,18,8);

idL="";
var idP="i_jalan|i_uptbina|i_wst|i_bum|i_pru|i_rtsp|i_rskp|info4|info2|info8|infokp|info";
var idP="i_jalan|i_prm|i_sp|i_wst|i_bum|i_pru|i_rtsp|i_rskp|info4|info2|info8|infokp|info";

var idR="10-21|10-21|10-18|4-21|4-21|4-21|10-18|10-18|4-17|4-18|6-21|6-21|6-21";


 if ($('.leaflet-control-layers-selector')[21].checked){idL="1|"; } else {idL="|";}

for(j=0;j<12;j++)
{
   var idLC="";
   var ii=idLA[j];
      if ($('.leaflet-control-layers-selector')[ii].checked) { idLC="1";} 
   idL=idL+idLC+"|";
}
  
  if(idL>"")
  {
   
    $.post(urlinfo +'/i.php', { x: x, y: y,z: z, w:w ,mz:mz,idL:idL,idP:idP,idR:idR }, function(data){
      
     markersLayer.clearLayers();
    
     if(data>"") 
     {
       
        var obj = JSON.parse(data);
         if(obj.layer=="infojalan")
        {
            infoke2(obj,100);
        }
 
        if(obj.layer=="info8")
        {
           infoHPL(obj,'HPL&nbsp;TRANS');
        } 
                if(obj.layer=="infokp")
        {
           infoHPL(obj,'KAWASAN&nbsp;TRANS&nbsp;DESA');
        } 

        if(obj.layer=="info")
        {
           infoSK(obj,mz);
        }
         if(obj.layer=="info2")
        {
           infoke2(obj,mz);
        }
	     
       
     }
     else
     {
       if($('.leaflet-control-layers-selector')[19].checked)
       {
           $.post('https://kunmap.net/bigmap/infodesa.php', { x: x, y: y,z: z, w:w ,mz:mz ,myurl:'https://kunmap.net' }, function(data){
               if(data>"")
            {
                
               var obj = JSON.parse(data);
                 
                 if(obj.isi>"") {
                  popup
                       .setLatLng([y,x])
                       .setContent('<b>'+obj.judul+'</b><hr>'+obj.isi)
                       .openOn(map); 
                          var z1=z/10; 
                     var x1=x ; var y1=y; var x2=x+z1; var y2=y;var x3=x;var y3=y-z1;

                     
                      var marker4 = new   L.polygon(JSON.parse(obj.pol));mypol=JSON.parse(obj.pol);
 					
 					markersLayer.addLayer(marker4);
 					map.addLayer(markersLayer);
                     
                      }
               
            } 
           });
       }
     }
    }
   );
  }

lewat=1;

if ($('.leaflet-control-layers-selector')[6].checked)
{
 
 if ( mz<6)
 {
  lewat=1;
    $.post(urlinfo +'/infoprov.php', { x: x, y: y,z: z, w:w ,mz:mz }, function(data){
      
     markersLayer.clearLayers();
      
     if(data>"") {
         var obj = JSON.parse(data);
           
            var bts=obj.pol;bts=bts.split(" ");//100.053658 -1.120413 103.806961 2.534235 ;
              x1=bts[0]*1;y1=bts[1]*1;x2=bts[2]*1;y2=bts[3]*1;
            map.fitBounds([
            [y2, x1],
           [y1,x2]
           ])
      } 
             
        }).fail(function() { });
 }
}



});



map.on('mousemove', function(e){
          var y=e.latlng.lat;
         var x=e.latlng.lng;
         infopos(x,y);
});

function loadsinergitasKL(ddd)
{
   $.post(urlinfo+'/sinergitasKL.php', { d:ddd }, function(data){
    if(data>"")
     
            {
               document.getElementById('tabi7').innerHTML=data;
            }
      
   } );
}
function loaddocs(ddd)
{
 
    $.post(urlinfo+'/info3.php', { d:ddd }, function(data){
             
       if(data>"")
            {
            
              
              var dd=data.split('\n') 
                jud=dd[0].toUpperCase();
               
                 
                var jud=jud.split('\t');
               
                 var ss="<table>";
                  for(j=1;j<dd.length;j++)
                  {
                     
                     isi=dd[j].split('\t');
                     if(isi.length>3)
                    {
                          ss+="<tr bgcolor=#dddddd ><td colspan=2 ><b>#"+j +"</b></td></tr>";
                         for(k=2;k<jud.length;k++)
                         {
                           if(jud[k]>" ")
                           {
                           ss+="<tr><td bgcolor=#eeeeff >"+jud[k] +"</td><td bgcolor=#ddffdd >"+  isi[k] + "</td></tr>";
                           }
                         }
                     }
                  }
                  ss+="</table>";
                 
                  document.getElementById('docs').innerHTML=ss;
              }
            else {
             document.getElementById('docs').innerHTML='';
            }
   });

}

function V_PDF(a)
{
  
    var f1=document.getElementById('fpdf');
      f1.action=pdamurl+subdir+"/pdf.php";
     f1.target=n1;
      f1.f.value=a;
     f1.submit(); 

//var hs= document.getElementById('hasil');
//    hs.style.display='block';
//    hs.innerHTML="<iframe width=100% height=500  src='https://sipukat.kemendesa.go.id/pdf.php?f="+ a+"'> </iframe>";
           
//   var p = $('#hasil');
//     var offset = p.offset();
 //    window.scrollBy(offset.left, offset.top);

                      
}

function v_peta2(a)
{
  document.getElementById('peta212').innerHTML="<img src='"+pdamurl+"/mesuji/PROFILE_"+a +"'  width=400% onclick=v_peta1('"+ a +"'); > ";
           
}

  
var ie=document.all;
var ns6=document.getElementById&&!document.all;
var dragapproved=false;
var xmouse=0;
var ymouse=0;
function move(e)
	{
		xmouse=ns6? e.clientX: event.clientX
		ymouse=ns6? e.clientY: event.clientY

	        if (ie){xmouse=xmouse-21;ymouse=ymouse-11;}
		ymouse+=document.body.scrollTop
		xmouse+=document.body.scrollLeft
		if (dragapproved)
		{
			zd.style.left=ns6? temp1+e.clientX-xd: temp1+event.clientX-xd;zd.style.top=ns6? temp2+e.clientY-yd : temp2+event.clientY-yd
			return false
		}      
	}
var cinfo=0;
function drags(e)
	{
		if (!ie&&!ns6)
			return;
			var firedobj=ns6? e.target : event.srcElement
			var topelement=ns6? 'HTML' : 'BODY'
			while (firedobj.tagName!=topelement&&firedobj.className!='pix')
			{
				firedobj=ns6? firedobj.parentNode : firedobj.parentElement
			}

		if( (firedobj.className=='pix')&(cinfo==0) )
		{
			dragapproved=true
			zd=firedobj;temp1=parseInt(zd.style.left+0)
			temp2=parseInt(zd.style.top+0)
			xd=ns6? e.clientX: event.clientX
			yd=ns6? e.clientY: event.clientY
			document.onmousemove=move
			return false
		}
	}
	//=========================================================================================================================================
	document.onmousedown=drags;document.onmouseup=new Function('dragapproved=false');document.onmousemove=move;
	//=========================================================================================================================================


var jg = new jsGraphics("myCanvas");
 jg.setColor("#00ffff");jg.setStroke(2);

var jg_n=0;
var jg_x=new Array();
var jg_y=new Array();

function jeder()
{
 if(jg_n>0)
  {
    //jg.clear();
    //var xx=new Array(); var yy=new Array;
    //for(var j=0;j<jg_n;j++)
   // {
    //  xx[j]=jg_x[j];yy[j]=jg_y[j]; 
    //}
    // xx[jg_n]=xmouse;yy[jg_n]=ymouse-2; 
    //jg.drawPolygon(xx, yy);
    // jg.paint();
  }
}

 var gt=0;
 var ng=0;
function derder()
{
  var xt=(map.getBounds().getEast() + map.getBounds().getWest())/2;
  var yt=(map.getBounds().getNorth() + map.getBounds().getSouth())/2;

 tarikGrs  (yt,xt); 
  
 
}


function onErrorlok(){alert('GPS belum siap..ulangi lagi!');}
var sxy="";

var Gs="<form id=form16 action=jaring.php method=post target='g";


function doborder()
{
 jg_n=0;
 if(ng>2 )
 {
  
  document.getElementById("myCanvas").style.display="none";
  var s=Gs+gt+"' ><textarea name=batas >";

   s=s+sxy;
   s=s+"</textarea><input name=x1 value='"+ map.getBounds().getWest()+"'>";
   s+="<input name=x2 value='"+ map.getBounds().getEast() +"'>";
    s=s+"<input name=y1 value='"+ map.getBounds().getSouth() +"'>";
    s=s+"<input name=y2 value='"+ map.getBounds().getNorth() +"'>";

    s=s+"<input name=w value='"+   $(document).width()+"'>";
    s=s+"<input name=h value='"+$(document).height()+"'>";
   s=s+"<input name=limite value=0 ><input name=mslink value=0 ></form><script>document.getElementById('form16').submit();</script>";
    
    $("#hasil").html(s);   
    document.getElementById("zonku").src='area.png';
  ng=0;
 }else
 {
  jg.clear();ng=0;sxy="";
  document.getElementById("myCanvas").style.display="block";
  document.getElementById("zonku").src='area1.png';
 }
}



 function SN(id,p)
  {
    var d = new Date();
   gt = d.getTime();
    var s="<form id=form16 action="+p+".php method=post target='sn"+gt+"' ><input name=id value='"+id+"'>";  
     s+="<input name=x2 value='"+ map.getBounds().getEast() +"'>";
    s+="<input name=y1 value='"+ map.getBounds().getSouth() +"'>";
    s+="<input name=y2 value='"+ map.getBounds().getNorth() +"'>";

    s=s+ " </form><script>document.getElementById('form16').submit();</script>"; 
     $("#hasil").html(s);      
  }

 function shareloc(x,y)
{
  window.open("https://www.google.com/maps?q="+y+","+x,"t"+x);
}

function doquery(m=0,n=0)
 {
  
  var pil2=document.getElementById('pilC').value;
 
 
   $("#resultquery").html('...tunggu');

    var idq=document.getElementById('idquery').value; var s2=idq.toUpperCase();
    var s1="<div style='width:200px; height:130px;overflow:auto' > <table bgcolor=#ffffff  CELLPADDING=0  CELLSPACING=0   width=100%  >";
 if(pil2==2)
 {
  if ($('.leaflet-control-layers-selector')[15].checked){} else  {
  $('.leaflet-control-layers-selector')[15].click();}
   var s3='';
    var nom=0;
   for(j=0;j<npu;j++)
   {
     s4=lpu[j]; 
    s3=s4.split(s2);
      if (s3.length>1) 
     {   nom++;
        s3=s4.split("|");
          s5=s3[1];
          s6=s3[2]+" di <span style='color:#dd0000;cursor:pointer' onclick=gotoxy("+s3[3]+","+s3[4]+") > ";
        s1+="<tr><td>"+nom+". </td><td>"+s6+s5+"</span></td></tr>";     
     }
   }  
   s1+="</table></div> "; 
  $("#resultquery").html(s1); 
  document.getElementById("resultquery").style.display='block';
 }
 if(pil2==1)
 {
    $.post( pdamurl+subdir+'/query.php',{idq:idq,m:m,n:n},function(data)
    { 
   
         if(data>"")
       {var obj=JSON.parse(data);$("#resultquery").html(obj.isi);document.getElementById("resultquery").style.display='block';
       } else {$("#resultquery").html(''); alert('gagal Search.');} 
     }).fail(function(){alert('gagal Search.')})
 }

 if(pil2>2)
 {
    $.post( pdamurl+subdir+'/query'+ pil2+ '.php',{idq:idq,m:m,n:n},function(data)
    { 
   
         if(data>"")
       {var obj=JSON.parse(data);$("#resultquery").html(obj.isi);document.getElementById("resultquery").style.display='block';
       } else {$("#resultquery").html(''); alert('gagal Search.');} 
     }).fail(function(){alert('gagal Search.')})
 }

}

function gotoxy(x,y){
  map.setView([y,x],11);

}

//document.getElementById("myCanvas").style.display="none";

//document.getElementById("kunmapku").innerHTML="<input type=button value='PLN - Jogjakarta' >";

//document.getElementById("menuku").innerHTML="<div style='background: #fff;padding: 8px;border-radius: 6px;' > <input size=15 id=idquery  >&nbsp;<input type=button value=Do  onclick=doquery() > <b style='cursor:pointer;color:#0000ff' onclick=tampilmenuku('none'); > << </b> <br><span id=resultquery > </span></div> ";

// document.getElementById("iconku").innerHTML="<img src=cari.png onclick=tampilmenuku('block'); >";

function tampilmenuku(s1)
{
 document.getElementById("menuku1").style.display=s1;
}

//document.write("<img style='mouse:pointer;z-index: 9500;position:absolute;top:80px;left:10px' id='zonku' src='area.png' onclick=doborder() width=35px height=35px >   ");
function kunfresh()
{
 var xtrans=106.8507;
 var ytrans=-6.25475;

   map.setView([ytrans,xtrans],18);
  $.post( pdamurl+subdir+'/rekun.php',{id:1},function(data)
    { 

  popup
                       .setLatLng([ytrans,xtrans])
                       .setContent(data)
                       .openOn(map); 
   });

  //jg.clear();ng=0;
 // document.getElementById("myCanvas").style.display="none";
 // document.getElementById("zonku").src='area.png';
 // jg_n=0;
//var s="<hr>81.133 Desa <br> 14.591.739 Vertex Koordinat<br>";
//s+="<b style='cursor:pointer;color:#0000ff' onclick=you_here();>You here</b>&nbsp;|&nbsp;";
//s+="<b style='cursor:pointer;color:#0000ff' onclick=$('#resultquery').html('');>Close</b>";
 //  $("#resultquery").html(s);
  // if(navigator.geolocation)
   //    { navigator.geolocation.getCurrentPosition(handleGetCurrentPosition, onErrorlok);}
}

function you_here()
{
   if(navigator.geolocation)
       { navigator.geolocation.getCurrentPosition(handleGetCurrentPosition, onErrorlok);}

}

 function tutup()
{
  $("#resultquery").html('');
}
  
function pesanku()
{
  ///var s='<hr> <b style=\'color:#aa5500\'> Peta Administrasi ini  tidak untuk<br> acuan hukum apapun,<br>';
   // s+=' kecuali sekedar sebagai <br> pemandu navigasi. </b> <br>Silahkan cari Desa  <br>berdasarkan kombinasi nama  <hr>';
    
    //s+='<input type=button value=Close onclick=tutup();>';
   // $("#resultquery").html(s);
   // document.getElementById('idquery').value='';
 // document.getElementsByTagName("div")[3].style.display='block';

 // document.getElementsByTagName("div")[3].style.top='300px';
}
//setTimeout('pesanku()',1500);

function go2google(y,x)
{
 window.open('http://maps.google.com/maps?q='+y+','+x);
}


//  var searchControl = new L.esri.Controls.Geosearch().addTo(map);

  var results = new L.LayerGroup().addTo(map);

//  searchControl.on('results', function(data){
//    results.clearLayers();
//    for (var i = data.results.length - 1; i >= 0; i--) {
//      results.addLayer(L.marker(data.results[i].latlng));
//    }
//  });

//setTimeout(function(){$('.pointer').fadeOut('slow');},3400);

function rekaps()
{
kunfresh();
}

function openCity(cityName) {
   var i;
  var x = document.getElementsByClassName("city");
  for (i = 0; i < x.length; i++) {
    x[i].style.display = "none";  
  }
  document.getElementById(cityName).style.display = "block";  
}
function pesan212()
{
 alert('Perhatian!!\r\nDirektorat Jenderal Pembangunan dan Pengembangan Kawasan Transmigrasi  tidak bertanggung jawab terhadap kesalahan atau kerugian yang timbul akibat penyalahgunaan data/informasi yang disajikan atau akibat pihak lain yang menggunakan service dari SIPUKAT');
}
setTimeout(pesan212,100);